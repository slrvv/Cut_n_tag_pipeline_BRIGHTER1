mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no')) %>%
str_split_fixed(peakType,".",2)[2]
peak_new <- peak %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
View(peak)
View(peak_new)
peak_new <- peak %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
peak_new <- peak_new %>%
gsub("_peaks.","",as.character(peak_new$peakType))
gsub("_peaks.","",as.character(peak_new$peakType))
peak_new$peakType<-gsub(".","",as.character(peak_new$peakType))
is.atomic(peak_new$peakType)
peak_new <-peak_new %>%
separate(peakType, c("remove", "peakType"), ".")
lapply(peak, class)
peak_new <-peak_new %>%
separate(peakType, into = c("remove", "peakType"),
sep = ".", fill = "left")
peak_new <- peak_new %>%
tidyr::separate(peakType, into = c("remove", "peakType"),
sep = ".", fill = "left")
peak_new <- peak %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
projectPath <- "X:/Celeste/2024_summer_complete/alignment"
peakpath <- paste0(projectPath, "/summary_peak_calling_MACS2.txt")
peakWidthPath <- paste0(projectPath, "/summary_peak_calling_width_MACS2.txt")
fripsPath <- paste0(projectPath, "/summary_peak_calling_frips_MACS2.txt")
peak <- read.table(peakpath, header=T)
peakWidth <- read.table(peakWidthPath, header=T)
frips <- read.table(fripsPath, header=T)
peak_new <- peak %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
peak_new <- peak_new %>%
separate(Histone,
c("cell_line", "target"),
sep = "[^[:alnum:]]+", extra = "merge", fill = "right") %>%
filter(target != "h3k4me1" )%>%
filter(target != "h3k36me3" )
peak_new$target <- factor(peak_new$target,
levels = c("gfp", "flag", "his",
"rpa70",
"h3k4me3", "h3k4me1", "h3k36me3",
"igg") )
mycolors <- c("black", "black", "black", "darkgreen", "darkblue", "darkred")
fig7A = peak_new %>%
filter( rem_dupl == "no") %>%
ggplot(aes(x = target, y = peakN,
fill = cell_line)) +
geom_boxplot() +
#geom_jitter(aes(color = as.factor(Replicate)), position = position_jitter(0.15)) +
facet_grid(~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("Number of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7A
View(peakWidth)
peakWidth <- peakWidth %>%
separate(Histone,
c("cell_line", "target"),
sep = "[^[:alnum:]]+", extra = "merge", fill = "right") %>%
filter(target != "h3k4me1" )%>%
filter(target != "h3k36me3" )
peakWidth$target <- factor(peakWidth$target,
levels = c("gfp", "flag", "his",
"rpa70",
"h3k4me3", "h3k4me1", "h3k36me3",
"igg") )
fig7B = peakWidth %>%
ggplot(aes(x = target, y = width,
fill = cell_line)) +
geom_violin() +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
scale_y_continuous(trans = "log", breaks = c(400, 3000, 22000)) +
theme_bw(base_size = 14) +
ylab("Width of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7B
peakWidth <- read.table(peakWidthPath, header=T) %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
peakWidth <- peakWidth %>%
separate(Histone,
c("cell_line", "target"),
sep = "[^[:alnum:]]+", extra = "merge", fill = "right") %>%
filter(target != "h3k4me1" )%>%
filter(target != "h3k36me3" )
peakWidth$target <- factor(peakWidth$target,
levels = c("gfp", "flag", "his",
"rpa70",
"h3k4me3", "h3k4me1", "h3k36me3",
"igg") )
fig7B = peakWidth %>%
ggplot(aes(x = target, y = width,
fill = cell_line)) +
geom_violin() +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
scale_y_continuous(trans = "log", breaks = c(400, 3000, 22000)) +
theme_bw(base_size = 14) +
ylab("Width of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7B
View(peakWidth)
fig7B = peakWidth %>%
filter( rem_dupl == "no") %>%
ggplot(aes(x = target, y = width,
fill = cell_line)) +
geom_violin() +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
scale_y_continuous(trans = "log", breaks = c(400, 3000, 22000)) +
theme_bw(base_size = 14) +
ylab("Width of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7B
fig7B = peakWidth %>%
filter( rem_dupl == "no") %>%
ggplot(aes(x = target, y = width,
fill = cell_line)) +
geom_violin() +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
#scale_y_continuous(trans = "log", breaks = c(400, 3000, 22000)) +
theme_bw(base_size = 14) +
ylab("Width of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7B
fig7B = peakWidth %>%
filter( rem_dupl == "no") %>%
ggplot(aes(x = target, y = width,
fill = cell_line)) +
geom_violin() +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
scale_y_continuous(trans = "log", breaks = c(100, 500, 1000, 5000)) +
theme_bw(base_size = 14) +
ylab("Width of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7B
fig7C = peak_new %>%
filter( rem_dupl == "no")  %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.1, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7C
View(peak_new)
fig7C = peak_new %>%
filter( rem_dupl == "no")  %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = peakType,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.1, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12)) +
facet_wrap(~cell_line)
fig7C
fig7C = peak_new %>%
filter( rem_dupl == "no")  %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.1, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12)) +
facet_wrap(~peakType)
fig7C
fig7C = peak_new %>%
filter( rem_dupl == "no")  %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.1, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7C
fig7C = peak_new %>%
filter( rem_dupl == "no")  %>%
filter( cell_line == "HBD") %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.1, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7C
peak_new %>%
filter( rem_dupl == "no")  %>%
filter( cell_line == "HBD") %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.2, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
peak_new %>%
filter( rem_dupl == "no")  %>%
filter( cell_line == "WKK") %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.2, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
peak_new %>%
filter( rem_dupl == "no")  %>%
filter( cell_line == "wt") %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.2, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
View(peak)
View(peak_new)
peak_new %>%
filter( rem_dupl == "no")  %>%
filter( cell_line == "WT") %>%
ggplot(aes(x = target, y = peakReprodRate,
fill = cell_line ,
label = round(peakReprodRate, 2))) +
geom_bar(stat = "identity") +
geom_text(vjust = -0.2, size = 3) +
facet_grid(Replicate~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Peaks Reproduced") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
View(fig7B)
fig7D = frips %>%
ggplot(aes(x = Histone, y = frip,
fill = Histone,
label = round(frip, 2))) +
geom_boxplot() +
geom_jitter(aes(color = as.factor(Replicate)), position = position_jitter(0.15)) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("% of Fragments in Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7D
#-----------------------Paths and libraries------------------------------------#
library(ggplot2)
library(viridis)
library(dplyr)
library(ggpubr)
library(RColorBrewer)
library(tidyr)
library(stringr)
projectPath <- "X:/Celeste/2024_summer_complete/alignment"
peakpath <- paste0(projectPath, "/summary_peak_calling_MACS2.txt")
peakWidthPath <- paste0(projectPath, "/summary_peak_calling_width_MACS2.txt")
fripsPath <- paste0(projectPath, "/summary_peak_calling_frips_MACS2.txt")
peak <- read.table(peakpath, header=T) %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
peakWidth <- read.table(peakWidthPath, header=T) %>%
mutate(rem_dupl = case_when(
startsWith(peakType, "_rmDup") == T ~ 'yes',
TRUE ~ 'no'))
frips <- read.table(fripsPath, header=T)
peak <- peak %>%
separate(Histone,
c("cell_line", "target"),
sep = "[^[:alnum:]]+", extra = "merge", fill = "right") %>%
filter(target != "h3k4me1" )%>%
filter(target != "h3k36me3" )
peak$target <- factor(peak$target,
levels = c("gfp", "flag", "his",
"rpa70",
"h3k4me3", "h3k4me1", "h3k36me3",
"igg") )
peakWidth <- peakWidth %>%
separate(Histone,
c("cell_line", "target"),
sep = "[^[:alnum:]]+", extra = "merge", fill = "right") %>%
filter(target != "h3k4me1" )%>%
filter(target != "h3k36me3" )
peakWidth$target <- factor(peakWidth$target,
levels = c("gfp", "flag", "his",
"rpa70",
"h3k4me3", "h3k4me1", "h3k36me3",
"igg") )
mycolors <- c("black", "black", "black", "darkgreen", "darkblue", "darkred")
fig7A = peak %>%
filter( rem_dupl == "no") %>%
ggplot(aes(x = target, y = peakN,
fill = cell_line)) +
geom_boxplot() +
#geom_jitter(aes(color = as.factor(Replicate)), position = position_jitter(0.15)) +
facet_grid(~peakType) +
scale_fill_viridis(discrete = TRUE, begin = 0.1, end = 0.55, option = "magma", alpha = 0.8) +
scale_color_viridis(discrete = TRUE, begin = 0.1, end = 0.9) +
theme_bw(base_size = 14) +
ylab("Number of Peaks") +
xlab("") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust= 1, size=10,
colour = mycolors),
legend.title=element_text(size=12))
fig7A
library(ggplot2)
library(viridis)
library(dplyr)
library(ggpubr)
library(corrplot)
library(reshape2)
projectPath <- "X:/Celeste/2024_summer_complete"
# fill this variable with the same path as PROJECTROOT in
# the cut_and_tag_pipeline.sh script
repResultpath <- paste0(projectPath, "/alignment/rep_reproducibility_all_experiments.txt")
#histones
repResult <- read.table(repResultpath,
header=T)
# repResult
repResult_hist <- as.matrix(repResult)
corrplot(repResult_hist, method = "color",
order = 'hclust', type = "lower",
addCoef.col = "black", number.digits = 2, number.cex = 0.45,
tl.col = "black", tl.cex = 0.8)
# Dup Removed correlation
repResultDeduppath <- paste0(projectPath, "/alignment/rep_reproducibility_all_experiments_rmDup.txt")
#histones
repResultDedup <- read.table(repResultDeduppath,
header=T)
repResult_histDedup <- as.matrix(repResultDedup)
repResult_histDedup
corrplot(repResult_histDedup, method = "color",
order = 'hclust',type = "lower",
addCoef.col = "black", number.digits = 2, number.cex = 0.45,
tl.col = "black", tl.cex = 0.8)
projectPath <- "X:/Celeste/2024_summer_complete" #fill this variable with the same path as PROJECTROOT in
# the cut_and_tag_pipeline.sh script
repResultpath <- paste0(projectPath, "/alignment/rep_reproducibility_all_experiments.txt")
#histones
repResult <- read.table(repResultpath,
header=T)
head(repResult)
repResult_hist <- as.matrix(repResult)
corrplot(repResult_hist, method = "color",
addCoef.col = "black", number.digits = 2, number.cex = 0.65)
repResult_igg <- repResult[,c("HBD.igg_1", "HBD.igg_2",
"WKK.igg_1", "WKK.igg_2",
"WT.igg_1", "WT.igg_2")]
repResult_igg <- repResult_igg[c("HBD.igg_1", "HBD.igg_2",
"WKK.igg_1", "WKK.igg_2",
"WT.igg_1", "WT.igg_2"),]
repResult_igg <- as.matrix(repResult_igg)
hist_vec <- c("HBD.his_1", "HBD.his_2",
"WKK.his_1", "WKK.his_2",
"HBD.h3k4me3_1", "HBD.h3k4me3_2",
"WKK.h3k4me3_1", "WKK.h3k4me3_2",
"HBD.igg_1", "HBD.igg_2",
"WKK.igg_1", "WKK.igg_2")
repResult_hist <- repResult[,hist_vec]
repResult_hist <- repResult_hist[hist_vec,]
repResult_hist <- as.matrix(repResult_hist)
corrplot(repResult_igg, method = "color",addCoef.col = "black", number.digits = 2, number.cex = 0.65)
corrplot(repResult_hist, method = "color",addCoef.col = "black", number.digits = 2, number.cex = 0.65)
# Dup Removed correlation
repResultDeduppath <- paste0(projectPath, "/alignment/rep_reproducibility_all_experiments_rmDup.txt")
#histones
repResultDedup <- read.table(repResultpath,
header=T)
repResult_histDedup <- as.matrix(repResultDedup)
repResult_histDedup
corrplot(repResult_histDedup, method = "color",addCoef.col = "black", number.digits = 2, number.cex = 0.65)
projectPath <- "X:/Celeste/2024_summer_complete"
# fill this variable with the same path as PROJECTROOT in
# the cut_and_tag_pipeline.sh script
repResultpath <- paste0(projectPath,
"/alignment/rep_reproducibility_all_experiments.txt")
#histones
repResult <- read.table(repResultpath,
header=T)
View(repResult)
library(dplyr, quietly=TRUE)
args <- commandArgs(trailingOnly=TRUE)
projPath <- args[1]
summaryPath <- args[2]
dupRemove <- args[3]
print(dupRemove)
sampletable <- read.table(summaryPath,
header = T, sep = ",")
library(ggplot2)
library(viridis)
library(dplyr)
library(ggpubr)
library(corrplot)
library(reshape2)
projectPath <- "/project/ChromGroup_Seq_data/Celeste/2024_summer_complete"
repResultpath <- paste0(projectPath, "/alignment/rep_reproducibility_all_experiments.txt")
#histones
repResult <- read.table(repResultpath,
header=T)
# repResult
repResult_hist <- as.matrix(repResult)
corrplot(repResult_hist, method = "color",
order = 'hclust', type = "lower",
addCoef.col = "black", number.digits = 2, number.cex = 0.45,
tl.col = "black", tl.cex = 0.8)
